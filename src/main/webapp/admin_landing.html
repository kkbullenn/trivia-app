<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz Categories (Admin)</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#000814] text-white font-sans min-h-screen flex justify-center items-start py-12">
  <div class="w-full max-w-4xl bg-[#001D3D] rounded-2xl shadow-xl p-10">

    <!-- Header -->
    <header class="flex justify-between items-center border-b border-[#003566] pb-4 mb-6">
      <div class="flex items-center space-x-3">
        <span class="text-3xl">üë§</span>
        <p class="text-lg">Welcome, <b>admin</b></p>
      </div>
      <a href="#" onclick="history.back()"
         class="flex items-center gap-2 border border-[#FFC300] px-4 py-2 rounded-md text-[#FFC300] font-semibold hover:bg-[#FFC300] hover:text-black transition">
         <span class="text-xl">‚Üê</span><span>Back</span>
      </a>
    </header>

    <!-- Main Content -->
    <main class="space-y-10">
      <section>
        <h2 class="text-2xl font-bold text-[#FFD60A] mb-6">Select a Quiz Category</h2>
        <div id="category-container" class="grid grid-cols-3 md:grid-cols-4 gap-6">
          <p class="col-span-4 text-center text-gray-400">Loading categories...</p>
        </div>
      </section>

      <section>
        <h3 class="text-xl font-semibold text-[#FFD60A] mb-4">My Quizzes</h3>
        <div id="quiz-list" class="space-y-3"></div>

        <!-- Add Quiz Button -->
        <div class="flex justify-center mt-8">
          <button type="button"
            onclick="window.location.href='create-quiz'"
            class="bg-[#FFC300] text-black text-4xl w-14 h-14 rounded-full flex items-center justify-center hover:bg-[#FFD60A] transition">
            Ôºã
          </button>
        </div>
      </section>
    </main>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", async () => {
    const categoryContainer = document.getElementById("category-container");
    const quizList = document.getElementById("quiz-list");

    try {
      const res = await fetch("/trivia-app-prod/admin/data");
      const data = await res.json();

      // category
      const categories = data.categories || [];
      categoryContainer.innerHTML = categories.length
        ? categories.map(cat =>
            `<button class="bg-[#000814] border border-[#FFC300] rounded-xl text-base font-medium py-6 hover:bg-[#FFC300] hover:text-black transition">${cat["category-name"]}</button>`
          ).join("")
        : "<p class='col-span-4 text-center text-gray-400'>No categories available</p>";

      // quiz list
      const quizzes = data.quizzes || [];
      quizList.innerHTML = quizzes.length
        ? quizzes.map(q => `
            <div class="quiz-item flex justify-between items-center bg-[#003566] p-4 rounded-lg hover:bg-[#001D3D] transition">
              <p><b>${q["quiz-name"]}</b><br><span class="text-gray-300 text-sm">Status: ${q["quiz-status"]}</span></p>
              <button class="delete-btn inline-flex h-12 items-center justify-center rounded-md px-6 font-medium text-[#FFC300] shadow-lg shadow-[#FFC300]/20 border border-[#FFC300] transition active:scale-95 hover:text-[#FFD60A] hover:border-[#FFD60A]">Delete</button>
            </div>`).join("")
        : "<p class='text-center text-gray-400'>No quiz available.</p>";

      // delete button
      quizList.addEventListener("click", e => {
        if (e.target.classList.contains("delete-btn")) {
          const item = e.target.closest(".quiz-item");
          item.style.transition = "opacity 0.4s";
          item.style.opacity = "0";
          setTimeout(() => {
            item.remove();
            if (!quizList.children.length)
              quizList.innerHTML = "<p class='text-center text-gray-400'>No quiz available.</p>";
          }, 400);
        }
      });

    } catch {
      categoryContainer.innerHTML = "<p class='col-span-4 text-center text-red-400'>Failed to load categories.</p>";
    }
  });
  </script>
</body>
</html>
