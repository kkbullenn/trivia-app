<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create a Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#000814] text-white font-sans min-h-screen flex justify-center items-start py-12">

  <form action="create-quiz" method="POST" class="w-full max-w-3xl bg-[#001D3D] rounded-2xl p-10 space-y-10">

    <!-- Header -->
    <header class="flex justify-between items-center border-b border-[#003566] pb-4">
      <button type="button" onclick="window.location.href='admin-landing'" class="text-[#FFC300] text-3xl hover:text-[#FFD60A] transition">←</button>
      <h1 class="text-2xl font-bold text-[#FFD60A]">Create a Quiz</h1>
      <button type="button" onclick="addQuestion()" class="text-[#FFC300] text-3xl hover:text-[#FFD60A] transition">＋</button>
    </header>

    <!-- Quiz Name -->
    <section>
      <label class="block text-lg font-semibold text-[#FFD60A] mb-2">Quiz Name</label>
      <input name="session_name" type="text" required placeholder="Enter quiz title..." 
             class="w-full bg-[#000814] border border-[#FFC300] rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-[#FFD60A]" />
    </section>

    <!-- Category -->
    <section>
      <label class="block text-lg font-semibold text-[#FFD60A] mb-2">Category</label>
      <select id="categorySelect" name="category_id" required 
              class="w-full bg-[#000814] border border-[#FFC300] rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-[#FFD60A]">
        <option value="">Select a quiz category</option>
      </select>

    </section>

    <!-- Questions Container -->
    <div id="questionsContainer">

      <!-- Question 1 -->
      <section class="question bg-[#003566] rounded-xl p-6 space-y-4">
        <h3 class="text-xl font-bold text-[#FFD60A]">Question 1</h3>

        <!-- Question Text -->
        <input name="question_text_1" type="text" placeholder="Enter question text..." required
               class="w-full bg-[#000814] border border-[#FFC300] rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />

        <!-- Options -->
        <div class="space-y-2 mt-3">
          <label class="block font-semibold text-[#FFD60A]">Options</label>

          <div class="grid grid-cols-1 gap-2">
            <div class="flex items-center gap-2">
              <input name="option_a_1" type="text" placeholder="Option A" required
                     class="flex-1 bg-[#000814] border border-[#FFC300] rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />
              <label class="flex items-center gap-1 text-sm">
                <input type="radio" name="correct_option_1" value="A" required />
                Correct
              </label>
            </div>
            <div class="flex items-center gap-2">
              <input name="option_b_1" type="text" placeholder="Option B" required
                     class="flex-1 bg-[#000814] border border-[#FFC300] rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />
              <label class="flex items-center gap-1 text-sm">
                <input type="radio" name="correct_option_1" value="B" />
                Correct
              </label>
            </div>
            <div class="flex items-center gap-2">
              <input name="option_c_1" type="text" placeholder="Option C" required
                     class="flex-1 bg-[#000814] border border-[#FFC300] rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />
              <label class="flex items-center gap-1 text-sm">
                <input type="radio" name="correct_option_1" value="C" />
                Correct
              </label>
            </div>
            <div class="flex items-center gap-2">
              <input name="option_d_1" type="text" placeholder="Option D" required
                     class="flex-1 bg-[#000814] border border-[#FFC300] rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />
              <label class="flex items-center gap-1 text-sm">
                <input type="radio" name="correct_option_1" value="D" />
                Correct
              </label>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Create Button -->
    <div class="flex justify-center">
      <button type="submit" class="bg-[#FFC300] text-black font-semibold text-lg px-8 py-3 rounded-full hover:bg-[#FFD60A] active:scale-95 transition">
        Create Quiz
      </button>
    </div>
  </form>

  <script>
    let questionCount = 1;

    async function loadCategories() {
      try {
        const res = await fetch("/trivia-app-prod/admin/data", {
          method: "GET",
          credentials: "same-origin",
          headers: { "Accept": "application/json" }
        });
        if (!res.ok) throw new Error("HTTP " + res.status);

        const data = await res.json();
        const categories = data.categories;
        const select = document.getElementById("categorySelect");
        select.innerHTML = '<option value="">Select a quiz category</option>';

        categories.forEach(cat => {
          const opt = document.createElement("option");
          opt.value = cat["category-id"];
          opt.textContent = cat["category-name"];
          select.appendChild(opt);
        });
      } catch (err) {
        console.error("Failed to load categories", err);
      }
    }

    function addQuestion() {
      questionCount++;
      const container = document.getElementById("questionsContainer");

      const optionHTML = ["A","B","C","D"]
        .map(letter => `
          <div class="flex items-center gap-2">
            <input name="option_${letter.toLowerCase()}_${questionCount}" type="text" placeholder="Option ${letter}" required
                  class="flex-1 bg-[#000814] border border-[#FFC300] rounded-lg px-3 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />
            <label class="flex items-center gap-1 text-sm">
              <input type="radio" name="correct_option_${questionCount}" value="${letter}" ${letter === "A" ? "required" : ""}/>
              Correct
            </label>
          </div>
        `)
        .join("");

      const newSection = document.createElement("section");
      newSection.className = "question bg-[#003566] rounded-xl p-6 space-y-4";
      newSection.innerHTML = `
        <h3 class="text-xl font-bold text-[#FFD60A]">Question ${questionCount}</h3>
        <input name="question_text_${questionCount}" type="text" placeholder="Enter question text..." required
              class="w-full bg-[#000814] border border-[#FFC300] rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-[#FFD60A]" />
        <div class="space-y-2 mt-3">
          <label class="block font-semibold text-[#FFD60A]">Options</label>
          <div class="grid grid-cols-1 gap-2">${optionHTML}</div>
        </div>
      `;
      container.appendChild(newSection);
    }

    window.addEventListener("DOMContentLoaded", loadCategories);
</script>


</body>
</html>
